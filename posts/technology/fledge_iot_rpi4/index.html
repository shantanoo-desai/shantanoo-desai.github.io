<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><meta http-equiv=x-ua-compatible content="IE=edge, chrome=1"><title>Setting up and running LF-Edge's Fledge (from source) on a Raspberry Pi 4 - Shan's Corner</title><meta name=Description content="Shan's World"><meta property="og:title" content="Setting up and running LF-Edge's Fledge (from source) on a Raspberry Pi 4"><meta property="og:description" content><meta property="og:type" content="article"><meta property="og:url" content="https://shantanoo-desai.github.io/posts/technology/fledge_iot_rpi4/"><meta property="article:published_time" content="2021-07-29T15:48:16+02:00"><meta property="article:modified_time" content="2021-07-29T15:48:16+02:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Setting up and running LF-Edge's Fledge (from source) on a Raspberry Pi 4"><meta name=twitter:description content><meta name=application-name content="Shan's World"><meta name=apple-mobile-web-app-title content="Shan's World"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://shantanoo-desai.github.io/posts/technology/fledge_iot_rpi4/><link rel=prev href=https://shantanoo-desai.github.io/posts/technology/documenting_queries/><link rel=next href=https://shantanoo-desai.github.io/posts/technology/lf-edge-eden-qemu-part-1/><link rel=stylesheet href=/lib/normalize/normalize.min.css><link rel=stylesheet href=/css/style.min.css><link rel=stylesheet href=/lib/fontawesome-free/all.min.css><link rel=stylesheet href=/lib/animate/animate.min.css><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"Setting up and running LF-Edge's Fledge (from source) on a Raspberry Pi 4","inLanguage":"en","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/shantanoo-desai.github.io\/posts\/technology\/fledge_iot_rpi4\/"},"genre":"posts","keywords":"IoT, Edge Computing, Open Source, Raspberry Pi, Linux Foundation Projects","wordcount":1295,"url":"https:\/\/shantanoo-desai.github.io\/posts\/technology\/fledge_iot_rpi4\/","datePublished":"2021-07-29T15:48:16+02:00","dateModified":"2021-07-29T15:48:16+02:00","publisher":{"@type":"Organization","name":"Shan"},"author":{"@type":"Person","name":"Shan"},"description":""}</script></head><body header-desktop header-mobile><script type=text/javascript>(window.localStorage&&localStorage.getItem('theme')?localStorage.getItem('theme')==='dark':('auto'==='auto'?window.matchMedia('(prefers-color-scheme: dark)').matches:'auto'==='dark'))&&document.body.setAttribute('theme','dark');</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title="Shan's Corner">Shan's Corner</a></div><div class=menu><div class=menu-inner><a class=menu-item href=/posts/ title="My thoughts and works digitally transcribed">Posts </a><a class=menu-item href=/tags/>Tags </a><a class=menu-item href=/about/ title="Everything You wish to know about me">About </a><a class=menu-item href=/categories/>Categories </a><span class="menu-item delimiter"></span><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme"><i class="fas fa-adjust fa-fw"></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title="Shan's Corner">Shan's Corner</a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><a class=menu-item href=/posts/ title="My thoughts and works digitally transcribed">Posts</a><a class=menu-item href=/tags/>Tags</a><a class=menu-item href=/about/ title="Everything You wish to know about me">About</a><a class=menu-item href=/categories/>Categories</a><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw"></i></a></div></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>Contents</h2><div class="toc-content always-active" id=toc-content-auto></div></div><article class="page single"><h1 class="single-title animated flipInX">Setting up and running LF-Edge's Fledge (from source) on a Raspberry Pi 4</h1><div class=post-meta><div class=post-meta-line><span class=post-author><a href=/ title=Author rel=author class=author><i class="fas fa-user-circle fa-fw"></i>Shan</a></span>&nbsp;<span class=post-category>included in <a href=/categories/technology/><i class="far fa-folder fa-fw"></i>Technology</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime=29-07-2021>29-07-2021</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;1295 words&nbsp;
<i class="far fa-clock fa-fw"></i>&nbsp;7 minutes&nbsp;</div></div><div class="details toc" id=toc-static kept><div class="details-summary toc-title"><span>Contents</span>
<span><i class="details-icon fas fa-angle-right"></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#fledge>Fledge</a></li><li><a href=#getting-hands-dirty-already>Getting Hands Dirty already!</a><ul><li><a href=#hardware>Hardware</a></li><li><a href=#setup>Setup</a></li><li><a href=#south-plugin-installation>South-Plugin Installation</a></li></ul></li><li><a href=#setup--data-generation-for-sinusoid-plugin>Setup / Data Generation for Sinusoid Plugin</a></li><li><a href=#setup--data-generation-for-coap-plugin>Setup / Data Generation for CoAP Plugin</a></li><li><a href=#filter-plugins-in-fledge>Filter Plugins in Fledge</a><ul><li><a href=#applying-fft-on-the-our-sine-wave-asset>Applying FFT on the our Sine-Wave Asset</a></li></ul></li><li><a href=#outlook>Outlook</a></li></ul></nav></div></div><div class=content id=content><h2 id=fledge>Fledge</h2><blockquote><p>Fledge is an open source framework and community for the industrial edge focused on critical operations, predictive maintenance, situational awareness and safety. Fledge is architected to integrate Industrial Internet of Things (IIoT), sensors and modern machines with the cloud and existing “brown field” systems like historians, DCS (Distributed Control Systems), PLC (Program Logic Controllers) and SCADA (Supervisory Control and Data Acquisition). All sharing a common set of administration and application APIs.</p></blockquote><p>I wanted to give <a href=https://github.com/fledge-iot target=_blank rel="noopener noreffer">Fledge</a> a try to see how one can bring an open-source IoT/IIoT Stack to a quick realization.</p><h2 id=getting-hands-dirty-already>Getting Hands Dirty already!</h2><p>I had some <a href=https://github.com/fledge-iot/fledge/issues/439 target=_blank rel="noopener noreffer">problems trying to install Fledge using <code>apt</code></a> so I decided to install Fledge from Source.</p><h3 id=hardware>Hardware</h3><p><strong>Device</strong>: <strong>Raspberry Pi 4 Model B</strong>
<strong>Spec</strong>: 2GB RAM, 32GB Micro SD Card
<strong>Operating System</strong>: <strong>Ubuntu LTS 20.04.2</strong></p><h3 id=setup>Setup</h3><p>I am going to just clone stuff in my home directory</p><ol><li><p>Clone the <a href=https://github.com/fledge-iot/fledge target=_blank rel="noopener noreffer">fledge Repository</a></p><pre><code> $ git clone https://github.com/fledge-iot/fledge.git &amp;&amp; cd fledge/
</code></pre></li><li><p>Install the Dependencies (in the root directory of fledge)</p><pre><code>  $ sudo ./requirements.sh
</code></pre></li><li><p>Let&rsquo;s install fledge on the Pi</p><pre><code> $ sudo make install
</code></pre><p>grab something to munch on till the installation is complete</p></li><li><p>The installation will add the files and binaries in to the following directory: <code>/usr/local/fledge/</code>. You can export this path:</p><pre><code> $ export FLEDGE=/usr/local/fledge
</code></pre></li><li><p>start Fledge and check the status using the following:</p><pre><code> $ $FLEDGE/bin/fledge start
 $ $FLEDGE/bin/fledge status
</code></pre></li><li><p>Checkout the Fledge UI by hitting the Pi&rsquo;s IP Address: <code>http://&lt;IP_ADDRESS_of_PI></code></p></li></ol><p>At this point of time, Fledge is very <em>bare-metal</em> which implies there are lot of plugins that are missing. We begin by installing a very basic <em>simulated</em> plugin.</p><h3 id=south-plugin-installation>South-Plugin Installation</h3><h4 id=sinusoid>Sinusoid</h4><p>Since we are doing things by source, we need to clone the plugin repository. We start with a very basic <code>sinusoidal</code> South Plugin which will generate sine waves to the Fledge Core.</p><ol><li><p>clone the <a href=https://github.com/fledge-iot/fledge-south-sinusoid target=_blank rel="noopener noreffer"><code>fledge-south-sinusoid</code> plugin repository</a></p><pre><code> $ cd 
 $ git clone https://github.com/fledge-iot/fledge-south-sinusoid.git &amp;&amp; cd fledge-south-sinusoid/
</code></pre></li><li><p>we just need to copy the source code of the sine-wave generator to the directory path of plugins for Fledge</p><pre><code> $ # we are currently in the root directory of fledge-south-sinusoid
 $ sudo cp -r python/fledge/plugins/south/sinusoid $FLEDGE/python/fledge/plugins/south
</code></pre></li></ol><p>You can refresh the UI and click on the <strong>South</strong> Menu and you will be able to see <code>sinusoid</code> as a <strong>South Plugin</strong></p><h4 id=coap>CoAP</h4><p>Let&rsquo;s get one more Plugin into Fledge: CoAP plugin</p><ol><li><p>clone the <a href=https://github.com/fledge-iot/fledge-south-coap target=_blank rel="noopener noreffer"><code>fledge-south-coap</code> plugin repository</a></p><pre><code> $ cd 
 $ git clone https://github.com/fledge-iot/fledge-south-coap.git &amp;&amp; cd fledge-south-coap/
</code></pre></li><li><p>Let&rsquo;s copy the plugin&rsquo;s code to Fledge as we did previously</p><pre><code> $ # we are currently in the root directory of fledge-south-coap
 $ sudo cp -r python/fledge/plugins/south/coap $FLEDGE/python/fledge/plugins/south
</code></pre></li><li><p>Copy the python dependencies that are necessary to execute the plugin and install them:</p><pre><code> $ sudo cp -r python/requirements-coap.txt $FLEDGE/python/
 $ sudo pip3 - r $FLEDGE/python/requirements-coap.txt
</code></pre></li><li><p>Since the code is in the <code>/usr/local/</code> directory we need to provide root privileges to the coap plugin for execution by the Fledge Core</p><pre><code> $ sudo chown -R root:root $FLEDGE/python/fledge/plugins/south/coap
</code></pre></li></ol><p>That&rsquo;s it ! Now you have we two South Plugins in our Fledge Application that can provide us some simulated data!</p><p>Your UI <strong>South</strong> Menu should look like the following:</p><figure><img src=/images/technology/fledge-iot/fledge-south-plugins.png><figcaption><h4>Sinusoid & CoAP Plugins in the Fledge UI</h4></figcaption></figure><h2 id=setup--data-generation-for-sinusoid-plugin>Setup / Data Generation for Sinusoid Plugin</h2><ol><li>Let&rsquo;s setup the Sine-Wave Generator by naming it <code>test-sine-south</code> and click <strong>Next</strong></li></ol><figure><img src=/images/technology/fledge-iot/fledge-setup-sine-1.png><figcaption><h4>Sinusoid Plugin Setup in Fledge UI. Step 1</h4></figcaption></figure><ol start=2><li><p>Name the <strong>Asset Name</strong>. We name it <code>sine-wave-asset</code><figure><img src=/images/technology/fledge-iot/fledge-setup-sine-2.png><figcaption><h4>Name the Asset in Fledge UI. Step 1</h4></figcaption></figure></p></li><li><p>Make sure to enable the plugin by checking the <strong>Enabled</strong> checkbox and finally click <strong>Done</strong></p></li></ol><p>On the UI you now see the Sinusoid Plugin Enabled with active readings being fed into the Fledge Core. You can click on the link <code>test-sine-south</code> to change the configuration of the plugin / delete it or export readings to a file.</p><p>You can click on <strong>Assets & Readings</strong> Menu and click on the Graph Icon to get some visualization</p><figure><img src=/images/technology/fledge-iot/fledge-setup-sine-3.png><figcaption><h4>Assets & Readings of Sinusoid Wave</h4></figcaption></figure><p>And there you have visualization of the data coming in from your South Plugin, a lovely sine wave. Not practical but you get to understand how the Fledge Architecture would work!</p><figure><img src=/images/technology/fledge-iot/fledge-sine-visualization.png><figcaption><h4>Data Visualization of Sine Wave Asset</h4></figcaption></figure><p>You can click on the <strong>Summary</strong> tab to get some basic statistics of the information</p><h2 id=setup--data-generation-for-coap-plugin>Setup / Data Generation for CoAP Plugin</h2><ol><li>Let&rsquo;s setup the CoAP South Plugin similarly to Sinusoid by clicking on the <strong>+ Add</strong> button on the top-right of the Panel under <strong>South</strong> Page</li></ol><figure><img src=/images/technology/fledge-iot/fledge-setup-coap-1.png><figcaption><h4>Setting up CoAP South Plugin: Step 1</h4></figcaption></figure><ol start=2><li>Call the service <code>test-coap-south</code> and click <strong>Next</strong></li></ol><figure><img src=/images/technology/fledge-iot/fledge-setup-coap-2.png><figcaption><h4>Naming CoAP Service: Step 2</h4></figcaption></figure><ol start=3><li>In the next step keep the configuration as it is for now i.e. Port as <code>5683</code> and the URI as <code>sensor-values</code> and click <strong>Next</strong> and enable the plugin on the last setup.</li></ol><p>This should enable the CoAP Plugin for Fledge and it&rsquo;s time to generated some CoAP data from a simulated client to a CoAP Server running on the Pi.</p><p>Fledge does provide some testing information for CoAP in the core directory under the the CLI called <code>fogbench</code></p><p>Let&rsquo;s generate some CoAP data on the Pi.</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash><span class=nv>$FLEDGE</span>/bin/fogbench -t <span class=nv>$FLEDGE</span>/data/extras/fogbench/fogbench_sensor_coap.template.json -I <span class=m>100</span>
</code></pre></div><p>here <code>-t</code> flag is for mentioning a template and we use a coap template provided by Fledge mentioned above. <code>-I</code> is the time interval</p><p>Upon executing the command on the Pi, you can check the UI which will generate the following output for the CoAP Plugin.</p><figure><img src=/images/technology/fledge-iot/fledge-coap-data-1.png><figcaption><h4>Assets for Fogbench CoAP Service</h4></figcaption></figure><p>You can explore the Assets and Visualization by going to <strong>Assets & Readings</strong> and clicking on any of the asset you wish to observe.</p><blockquote><p>NOTE: In order to visualize live-data you can run the <code>fogbench</code> command above a couple of more times.</p></blockquote><figure><img src=/images/technology/fledge-iot/fledge-coap-visualization.png><figcaption><h4>Statistics for Luxometer Asset</h4></figcaption></figure><h2 id=filter-plugins-in-fledge>Filter Plugins in Fledge</h2><p>The sine wave isn&rsquo;t that cool to look at to so let&rsquo;s get some Frequency Domain Analysis on it with a <strong>Fast Fourier Transform</strong> on it using Fledge&rsquo;s FFT filter plugin</p><ol><li><p>Let&rsquo;s clone the plugin in the home directory</p><pre><code> $ cd 
 $ git clone https://github.com/fledge-iot/fledge-filter-fft.git &amp;&amp; cd fledge-filter-fft/
</code></pre></li><li><p>This plugin is not python based so we need to do some tasks for installing it. We export a <code>FLEDGE_ROOT</code> variable and create a <code>build</code> directory in the root of the repo</p><pre><code> $ # we export the directory where we built Fledge for the filter plugin to use
 $ export FLEDGE_ROOT=~/fledge/
 $ # in the root of the `fledge-filter-fft` repo
 $ mkdir build &amp;&amp; cd build/
</code></pre></li><li><p>compile the plugin</p><pre><code> $ cmake ..
</code></pre></li><li><p>install the plugin</p><pre><code> $ sudo make install
</code></pre></li></ol><p>Now you have the FFT plugin ready to be applied in Fledge</p><h3 id=applying-fft-on-the-our-sine-wave-asset>Applying FFT on the our Sine-Wave Asset</h3><ol><li><p>Let&rsquo;s head back to the <strong>South</strong> Plugins in the UI and click on the <code>test-sine-south</code> service</p></li><li><p>Click on the <strong>Applications</strong> menu for the Service</p></li></ol><figure><img src=/images/technology/fledge-iot/fledge-fft-setup-1.png><figcaption><h4>UI for test-sine-south Service</h4></figcaption></figure><ol start=3><li>Select <code>fft</code> from the available plugins and name the service <code>test-fft-sine</code></li></ol><figure><img src=/images/technology/fledge-iot/fledge-fft-setup-2.png><figcaption><h4>Name the FFT filter Plugin Service</h4></figcaption></figure><ol start=4><li>Setup the Service to conduct filtering on the asset called <code>sine-wave-asset</code> (See steps to setup Sinusoid Plugin) and other parameters as shown below (no fine tuning done here). Don&rsquo;t forget to click the <strong>Enabled</strong> checkbox and finally <strong>Done</strong></li></ol><figure><img src=/images/technology/fledge-iot/fledge-fft-setup-3.png><figcaption><h4>Configuring FFT Filter</h4></figcaption></figure><p>The Fast Fourier Transform might take some time to show up but you can head to <strong>Assets & Readings</strong> and click on the <code>sine-wave-asset FFT</code>'s Graph Icon to see some visualizations. This is what mine look like</p><figure><img src=/images/technology/fledge-iot/fledge-fft-visualization.png><figcaption><h4>FFT of the sine-wave-asset</h4></figcaption></figure><p>Great stuff. Imagine having vibration sensors and you need to conduct FFT analyses on it! Fledge makes it nifty!!</p><h2 id=outlook>Outlook</h2><p>The Fledge Project looks like something that could be a good solution for quick prototyping given on the <code>apt</code> issue is solved for me. Then it becomes a matter of doing the following:</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>apt install fledge fledge-ui .....
</code></pre></div><p>The only thing I can&rsquo;t find is where it is supported as a Docker/OCI container for deployment as an Edge Container. Nevertheless, Kudos to Fledge!</p></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>Updated on 29-07-2021</span></div><div class=post-info-license></div></div><div class=post-info-line><div class=post-info-md></div><div class=post-info-share><span><a href=javascript:void(0); title="Share on Twitter" data-sharer=twitter data-url=https://shantanoo-desai.github.io/posts/technology/fledge_iot_rpi4/ data-title="Setting up and running LF-Edge's Fledge (from source) on a Raspberry Pi 4" data-hashtags="IoT,Edge Computing,Open Source,Raspberry Pi,Linux Foundation Projects"><i class="fab fa-twitter fa-fw"></i></a><a href=javascript:void(0); title="Share on Facebook" data-sharer=facebook data-url=https://shantanoo-desai.github.io/posts/technology/fledge_iot_rpi4/ data-hashtag=IoT><i class="fab fa-facebook-square fa-fw"></i></a><a href=javascript:void(0); title="Share on Linkedin" data-sharer=linkedin data-url=https://shantanoo-desai.github.io/posts/technology/fledge_iot_rpi4/><i class="fab fa-linkedin fa-fw"></i></a><a href=javascript:void(0); title="Share on WhatsApp" data-sharer=whatsapp data-url=https://shantanoo-desai.github.io/posts/technology/fledge_iot_rpi4/ data-title="Setting up and running LF-Edge's Fledge (from source) on a Raspberry Pi 4" data-web><i class="fab fa-whatsapp fa-fw"></i></a><a href=javascript:void(0); title="Share on Hacker News" data-sharer=hackernews data-url=https://shantanoo-desai.github.io/posts/technology/fledge_iot_rpi4/ data-title="Setting up and running LF-Edge's Fledge (from source) on a Raspberry Pi 4"><i class="fab fa-hacker-news fa-fw"></i></a><a href=javascript:void(0); title="Share on Reddit" data-sharer=reddit data-url=https://shantanoo-desai.github.io/posts/technology/fledge_iot_rpi4/><i class="fab fa-reddit fa-fw"></i></a></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fas fa-tags fa-fw"></i>&nbsp;<a href=/tags/iot/>IoT</a>,&nbsp;<a href=/tags/edge-computing/>Edge Computing</a>,&nbsp;<a href=/tags/open-source/>Open-Source</a>,&nbsp;<a href=/tags/raspberry-pi/>Raspberry Pi</a>,&nbsp;<a href=/tags/linux-foundation-projects/>Linux Foundation Projects</a></section><section><span><a href=javascript:void(0); onclick=window.history.back();>Back</a></span>&nbsp;|&nbsp;<span><a href=/>Home</a></span></section></div><div class=post-nav><a href=/posts/technology/documenting_queries/ class=prev rel=prev title="How to (atleast) not get downvoted on StackExchange or anywhere: My Bug/Query Template"><i class="fas fa-angle-left fa-fw"></i>How to (atleast) not get downvoted on StackExchange or anywhere: My Bug/Query Template</a>
<a href=/posts/technology/lf-edge-eden-qemu-part-1/ class=next rel=next title="Exploring LF-Edge's EDEN and EVE Ecosystem QEMU - Part 1">Exploring LF-Edge's EDEN and EVE Ecosystem QEMU - Part 1<i class="fas fa-angle-right fa-fw"></i></a></div></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line>Powered by <a href=https://gohugo.io/ target=_blank rel="noopener noreffer" title="Hugo 0.70.0">Hugo</a> | Theme - <a href=https://github.com/dillonzq/LoveIt target=_blank rel="noopener noreffer" title="LoveIt 0.2.10"><i class="far fa-kiss-wink-heart fa-fw"></i>LoveIt</a></div><div class=footer-line><i class="far fa-copyright fa-fw"></i><span itemprop=copyrightYear>2021</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=/ target=_blank></a></span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title="Back to Top"><i class="fas fa-arrow-up fa-fw"></i></a><a href=# id=view-comments class=fixed-button title="View Comments"><i class="fas fa-comment fa-fw"></i></a></div><script type=text/javascript src=/lib/smooth-scroll/smooth-scroll.min.js></script><script type=text/javascript src=/lib/lazysizes/lazysizes.min.js></script><script type=text/javascript src=/lib/clipboard/clipboard.min.js></script><script type=text/javascript src=/lib/sharer/sharer.min.js></script><script type=text/javascript>window.config={"code":{"copyTitle":"Copy to clipboard","maxShownLines":50},"comment":{}};</script><script type=text/javascript src=/js/theme.min.js></script></body></html>